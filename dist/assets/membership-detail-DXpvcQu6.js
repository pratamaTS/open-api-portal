import{k as B,P as $,al as w,r as V,q as M,o as u,f as _,w as t,d as e,am as D,c as E,M as b,a2 as x,b as f,u as g,t as A}from"./index-BeDIi-I6.js";import{a as h}from"./axios-B6xwUs71.js";import{a as i,V as y}from"./VRow-DZPyfDQ-.js";import{V as I}from"./VCard-BFCMlRjy.js";import{V as C}from"./VGrid-Bfga6ToI.js";import{V as N}from"./VForm-CvWTOa-k.js";import{V as m}from"./VTextField-DanCElLj.js";import{V as O}from"./VSwitch-Da8DZ5Ms.js";import{V as S}from"./VAlert-Bqb0PorT.js";import"./VCardTitle-B1wKvJuT.js";import"./VImg-BUzEzs2C.js";import"./index-BKJEiBjI.js";import"./VSelectionControl-DNaZbdlg.js";const T={key:0,class:"text-red-500 text-sm"},j={__name:"MembershipDetailUpsert",setup(P){const d=B();$();const c=localStorage.getItem("id"),a=w({name:"",class:"",description:"",image_url:"",price:"",activation_period:0,is_active:0}),r=w({}),v=localStorage.getItem("token"),p=V(""),n=V("");V([]);const R=async l=>{try{const s=await h.get(`https://gateway.berkompeten.com/api/admin/master/membership/detail?id=${l}`,{headers:{Authorization:`Bearer ${v}`}});Object.assign(a,s.data.data)}catch(s){console.error("Error fetching membership data:",s)}},U=async()=>{try{a.is_active=a.is_active?1:0,await h({method:"post",url:"https://gateway.berkompeten.com/api/admin/master/membership/upsert",data:a,headers:{Authorization:`Bearer ${v}`}}),p.value="membership saved successfully!",setTimeout(()=>{k(),d.push("/membership-management")},2e3)}catch(l){console.error("Error submitting form:",l),l.response&&l.response.data?l.response.status===500?n.value=l.response.data.message||"An error occurred while saving. Please try again.":l.response.data.error?(Object.assign(r,l.response.data.message),console.log("ERROR: ",r)):n.value="An error occurred while saving. Please try again.":n.value="An error occurred while saving. Please try again."}},k=()=>{Object.assign(a,{name:"",class:"",description:"",image_url:"",price:"",activation_period:0,is_active:0})};return M(()=>{c?R(c):localStorage.removeItem("id")}),(l,s)=>(u(),_(y,null,{default:t(()=>[e(i,{cols:"12"},{default:t(()=>[e(I,{title:"Membership Details"},{default:t(()=>[e(C,null,{default:t(()=>[e(N,{onSubmit:D(U,["prevent"])},{default:t(()=>[e(y,null,{default:t(()=>[e(i,{cols:"12"},{default:t(()=>[e(m,{modelValue:a.name,"onUpdate:modelValue":s[0]||(s[0]=o=>a.name=o),"error-messages":r.name,label:"Name"},null,8,["modelValue","error-messages"])]),_:1}),e(i,{cols:"12"},{default:t(()=>[e(m,{modelValue:a.class,"onUpdate:modelValue":s[1]||(s[1]=o=>a.class=o),"error-messages":r.class,label:"Class"},null,8,["modelValue","error-messages"])]),_:1}),e(i,{cols:"12"},{default:t(()=>[e(m,{modelValue:a.description,"onUpdate:modelValue":s[2]||(s[2]=o=>a.description=o),"error-messages":r.description,label:"Description"},null,8,["modelValue","error-messages"])]),_:1}),e(i,{cols:"12"},{default:t(()=>[e(m,{modelValue:a.price,"onUpdate:modelValue":s[3]||(s[3]=o=>a.price=o),"error-messages":r.price,label:"Price",type:"number"},null,8,["modelValue","error-messages"])]),_:1}),e(i,{cols:"12"},{default:t(()=>[e(m,{modelValue:a.activation_period,"onUpdate:modelValue":s[4]||(s[4]=o=>a.activation_period=o),"error-messages":r.activation_period,label:"Activation Period",type:"number"},null,8,["modelValue","error-messages"])]),_:1}),e(i,{cols:"12"},{default:t(()=>[e(O,{color:"#0080ff",modelValue:a.is_active,"onUpdate:modelValue":s[5]||(s[5]=o=>a.is_active=o),"error-messages":r.is_active,label:"Is Active"},null,8,["modelValue","error-messages"]),r.image_url?(u(),E("div",T)):b("",!0)]),_:1}),e(i,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:t(()=>[e(x,{type:"submit",color:"#0080ff"},{default:t(()=>[f("Save")]),_:1}),e(x,{onClick:k,color:"secondary",variant:"outlined"},{default:t(()=>[f("Reset")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(C,null,{default:t(()=>[g(p)?(u(),_(S,{key:0,type:"success",dismissible:"","onClick:close":s[6]||(s[6]=o=>p.value="")},{default:t(()=>[f(A(g(p)),1)]),_:1})):b("",!0),g(n)?(u(),_(S,{key:1,type:"error",dismissible:"","onClick:close":s[7]||(s[7]=o=>n.value="")},{default:t(()=>[f(A(g(n)),1)]),_:1})):b("",!0)]),_:1})]),_:1})]),_:1})]),_:1}))}},ee={__name:"membership-detail",setup(P){const d=localStorage.getItem("token"),c=V(null),a=B();return M(async()=>{if(d)try{const r=await h.get("https://gateway.berkompeten.com/api/admin/profile",{headers:{Authorization:`Bearer ${d}`}});c.value=r.data}catch(r){r.response&&r.response.status===401&&a.push("/login")}else a.push("/login")}),(r,v)=>(u(),_(y,{class:"match-height"},{default:t(()=>[e(i,{cols:"12",md:"12"},{default:t(()=>[e(j)]),_:1})]),_:1}))}};export{ee as default};
